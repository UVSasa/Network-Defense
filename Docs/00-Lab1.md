# ğŸ§ª Blue Team Detection Lab â€“ Reconnaissance & Exfiltration Tool Monitoring

## ğŸ“– Overview

In this cybersecurity lab, I focused on detecting early-stage attacker activity by monitoring for the execution of **reconnaissance** and **credential access tools** often used in real-world breaches. The goal was to simulate how attackers operate in the initial phases of an attack and build **Blue Team detections** using **Wazuh** and **Sysmon**.

To achieve this, I created custom Wazuh rules that monitor **Sysmon Event ID 1 (Process Creation)** for suspicious process names commonly associated with attacker activity, including:

- `whoami.exe` â€“ user enumeration  
- `systeminfo.exe` â€“ system reconnaissance  
- `netstat.exe` â€“ network connection discovery  
- `cmd.exe`, `powershell.exe` â€“ command execution  
- `mimikatz.exe` / `mimi.exe` â€“ credential dumping  
- `nmap.exe` â€“ network scanning  
- `nc.exe` (netcat) â€“ data exfiltration or reverse shell  
- `procdump.exe` â€“ dumping LSASS memory

This lab showcases how defenders can catch malicious activity **early in the attack chain**, by identifying the use of tools that donâ€™t typically appear in normal user behavior.

---

## ğŸ¯ Objectives

- Detect suspicious process creation using Sysmon logs.
- Create custom Wazuh rules to trigger alerts on specific tools.
- Understand how attackers use legitimate tools to evade detection.
- Simulate realistic adversary behavior in a safe lab environment.
- Improve detection and alerting capabilities for common threat techniques.

---

## ğŸ” Why This Matters in Cybersecurity

Attackers rarely start with malware. Instead, they often use **built-in or widely available tools** during the **reconnaissance** and **credential access** phases of the cyber kill chain.

For example:
- `whoami` and `systeminfo` help determine the user's privileges and environment.
- `mimikatz` can extract passwords and tokens from memory.
- `netstat`, `nmap`, and `arp` help identify lateral movement targets.
- `nc.exe` or `powershell` can be used to exfiltrate data or establish command and control (C2).

By detecting these tools early, defenders can interrupt the attack **before exploitation or data loss occurs**.

---

## ğŸ§° Tools & Technologies Used

- **Wazuh** â€“ for log collection, rule matching, and alerting
- **Sysmon** â€“ for detailed endpoint telemetry (especially process creation)
- **Kibana** â€“ for visualization and analysis of alerts
- **Windows 11 VM** â€“ target endpoint with Sysmon and Wazuh agent installed
- **Custom Rules** â€“ written in `local_rules.xml` to detect suspicious binaries

---

## ğŸ›  Custom Wazuh Rule Example



